/* Goo Engine gamepadpack 
 * Copyright 2014 Goo Technologies AB
 */
(function(window){function f(){
define("goo/addons/gamepadpack/GamepadComponent",["goo/entities/components/Component"],function(e){function t(e){this.type="GamepadComponent",this.buttonDownFunctions={},this.buttonUpFunctions={},this.buttonPressedFunctions={},this.leftStickFunction=null,this.rightStickFunction=null,this.gamepadIndex=e||0}return t.prototype=Object.create(e.prototype),t.prototype.constructor=t,t.prototype.setButtonDownFunction=function(e,t){this.buttonDownFunctions[e]=t},t.prototype.setButtonUpFunction=function(e,t){this.buttonUpFunctions[e]=t},t.prototype.setButtonPressedFunction=function(e,t){this.buttonPressedFunctions[e]=t},t.prototype.setLeftStickFunction=function(e){this.leftStickFunction=e},t.prototype.setRightStickFunction=function(e){this.rightStickFunction=e},t}),define("goo/addons/gamepadpack/GamepadData",["goo/math/Vector2"],function(e){function t(){this.leftStickDirection=new e,this.rightStickDirection=new e,this.buttonData={};var t=20;for(var n=0;n<t;n++)this.buttonData[n]={pressed:!1,down:!1,value:0};this.leftAmount=0,this.rightAmount=0}return t.prototype.recalculateData=function(e){this.recalculateSticks(e),this.recalculateButtons(e)},t.prototype.resetData=function(e){var t=e.buttons.length;for(var n=0;n<t;n++)this.buttonData[n].pressed=!1},t.prototype.recalculateButtons=function(e){var t=e.buttons,n=t.length;for(var r=0;r<n;r++){var i=t[r];i===1?this.buttonData[r].down=!0:(this.buttonData[r].down===!0&&(this.buttonData[r].pressed=!0),this.buttonData[r].down=!1),this.buttonData[r].value=i}},t.prototype.recalculateSticks=function(e){var t=e.axes,n=t[0],r=t[1];this.calculateStickDirection(this.leftStickDirection,n,r),this.leftAmount=this.calculateStickAmount(n,r);var i=t[2],s=t[3];this.calculateStickDirection(this.rightStickDirection,i,s),this.rightAmount=this.calculateStickAmount(i,s)},t.prototype.calculateStickDirection=function(e,t,n){e.setd(t,n);var r=e.length();r>1e-7&&(e.data[0]/=r,e.data[1]/=r)},t.prototype.calculateStickAmount=function(e,t){return Math.max(Math.abs(e),Math.abs(t))},t}),define("goo/addons/gamepadpack/GamepadSystem",["goo/entities/systems/System","goo/addons/gamepadpack/GamepadData"],function(e,t){function n(){e.call(this,"GamepadSystem",["GamepadComponent"]),this.gamepads=[],this.gamepadData=[];var n=4;for(var r=0;r<n;r++)this.gamepadData[r]=new t;if(navigator.webkitGetGamepads)this.updateGamepads=this.chromeGamepadUpdate;else{this.updateGamepads=function(){};var i=this;window.addEventListener("gamepadconnected",function(e){i.mozGamepadHandler(e,!0)},!1),window.addEventListener("gamepaddisconnected",function(e){i.mozGamepadHandler(e,!1)},!1)}}return n.prototype.checkGamepadMapping=function(e){e.mapping?e.mapping!=="standard"&&console.warn("Non-standard mapping set on gamepad #"+e.index):console.warn("No mapping set on gamepad #"+e.index)},n.prototype=Object.create(e.prototype),n.prototype.mozGamepadHandler=function(e,t){var n=e.gamepad;t?(this.gamepads[n.index]=n,this.checkGamepadMapping(n)):delete this.gamepads[n.index]},n.prototype.chromeGamepadUpdate=function(){var e=navigator.webkitGetGamepads(),t=e.length;for(var n=0;n<t;n++){var r=e[n];r&&(this.gamepads[r.index]=r)}},n.prototype.updateGamepadData=function(){this.updateGamepads();var e=this.gamepads.length;for(var t=0;t<e;t++){var n=this.gamepads[t];n&&this.gamepadData[n.index].recalculateData(n)}},n.prototype.resetGamepadData=function(){var e=this.gamepads.length;for(var t=0;t<e;t++){var n=this.gamepads[t];n&&this.gamepadData[n.index].resetData(n)}},n.prototype.process=function(e){this.updateGamepadData();var t=e.length;for(var n=0;n<t;n++){var r=e[n],i=r.gamepadComponent,s=i.gamepadIndex,o=this.gamepadData[s],u=this.gamepads[s];if(!u)return;var a,f,l;i.leftStickFunction&&(a=u.axes[0],f=u.axes[1],l=[a,f],i.leftStickFunction(r,o.leftStickDirection,o.leftAmount,l)),i.rightStickFunction&&(a=u.axes[2],f=u.axes[3],l=[a,f],i.rightStickFunction(r,o.rightStickDirection,o.rightAmount,l));var c,h;for(c in i.buttonDownFunctions)h=o.buttonData[c],h.down===!0&&i.buttonDownFunctions[c](r,h.value);for(c in i.buttonUpFunctions)h=o.buttonData[c],h.down===!1&&i.buttonUpFunctions[c](r,h.value);for(c in i.buttonPressedFunctions)h=o.buttonData[c],h.pressed===!0&&i.buttonPressedFunctions[c](r,h.value)}this.resetGamepadData()},n}),define("goo/addons/gamepadpack/GamepadRegister",["goo/scripts/Scripts","goo/addons/gamepadpack/GamepadComponent","goo/addons/gamepadpack/GamepadSystem","goo/addons/gamepadpack/GamepadData"],function(e){var t=["goo/scripts/Scripts","goo/addons/gamepadpack/GamepadComponent","goo/addons/gamepadpack/GamepadSystem","goo/addons/gamepadpack/GamepadData"];for(var n=1;n<t.length;n++){var r=t[n].slice(t[n].lastIndexOf("/")+1);e.addClass(r,arguments[n])}}),require(["goo/addons/gamepadpack/GamepadComponent","goo/addons/gamepadpack/GamepadData","goo/addons/gamepadpack/GamepadRegister","goo/addons/gamepadpack/GamepadSystem"],function(e,t,n,r){var i=window.goo;if(!i)return;i.GamepadComponent=e,i.GamepadData=t,i.GamepadRegister=n,i.GamepadSystem=r}),define("goo/addons/gamepadpack/gamepadpack",function(){});
}try{
if(window.localStorage&&window.localStorage.gooPath){
window.require.config({
paths:{goo:localStorage.gooPath}
});
}else f()
}catch(e){f()}
})(window)